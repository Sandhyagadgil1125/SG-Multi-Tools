<script>
// --- EMI CALCULATOR LOGIC ---
// Formula: E = P x r x (1 + r)^n / ((1 + r)^n - 1)
function calcEMI() {
    const P = parseFloat(document.getElementById('p').value); // Principal
    const annualRate = parseFloat(document.getElementById('r').value); // Annual Interest
    const N = parseFloat(document.getElementById('n').value); // Tenure in Months

    if (!P || !annualRate || !N) {
        document.getElementById('mRes').innerText = "Please fill all fields";
        return;
    }

    const r = annualRate / 12 / 100; // Monthly Interest Rate
    const emi = (P * r * Math.pow(1 + r, N)) / (Math.pow(1 + r, N) - 1);
    const totalPayment = emi * N;
    const totalInterest = totalPayment - P;

    document.getElementById('mRes').innerHTML = `
        <div style="text-align:left;">
            <p>Monthly EMI: <strong>₹${emi.toLocaleString('en-IN', {maximumFractionDigits: 2})}</strong></p>
            <p>Total Interest: ₹${totalInterest.toLocaleString('en-IN', {maximumFractionDigits: 0})}</p>
            <p>Total Amount: ₹${totalPayment.toLocaleString('en-IN', {maximumFractionDigits: 0})}</p>
            <button class="btn-action" style="background:#fff; font-size:0.7rem;" onclick="copyToClipboard('${emi.toFixed(2)}')">Copy EMI Value</button>
        </div>
    `;
}

// --- SIP CALCULATOR LOGIC ---
// Formula: FV = P x ({[1 + i]^n - 1} / i) x (1 + i)
function calcSIP() {
    const P = parseFloat(document.getElementById('mSip').value); // Monthly Investment
    const annualRate = parseFloat(document.getElementById('mRate').value); // Expected Return
    const years = parseFloat(document.getElementById('mTime').value); // Duration

    if (!P || !annualRate || !years) {
        document.getElementById('mRes').innerText = "Please fill all fields";
        return;
    }

    const i = (annualRate / 100) / 12; // Monthly Interest Rate
    const n = years * 12; // Total Months
    
    const maturityValue = P * ((Math.pow(1 + i, n) - 1) / i) * (1 + i);
    const investedAmount = P * n;
    const estReturns = maturityValue - investedAmount;

    document.getElementById('mRes').innerHTML = `
        <div style="text-align:left;">
            <p>Maturity Value: <strong>₹${maturityValue.toLocaleString('en-IN', {maximumFractionDigits: 0})}</strong></p>
            <p>Invested Amount: ₹${investedAmount.toLocaleString('en-IN')}</p>
            <p>Est. Returns: ₹${estReturns.toLocaleString('en-IN', {maximumFractionDigits: 0})}</p>
            <button class="btn-action" style="background:#fff; font-size:0.7rem;" onclick="copyToClipboard('${maturityValue.toFixed(0)}')">Copy Maturity Total</button>
        </div>
    `;
}

// Helper: Copy to Clipboard
function copyToClipboard(val) {
    navigator.clipboard.writeText(val);
    alert("Copied to clipboard: " + val);
}
</script>
